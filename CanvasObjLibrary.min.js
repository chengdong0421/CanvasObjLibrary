/*
MIT LICENSE
Copyright (c) 2016 iTisso
https://github.com/iTisso/CanvasObjLibrary
*/'use strict';var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,'value'in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}();function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return call&&('object'==typeof call||'function'==typeof call)?call:self}function _inherits(subClass,superClass){if('function'!=typeof superClass&&null!==superClass)throw new TypeError('Super expression must either be null or a function, not '+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError('Cannot call a class as a function')}(function(){function a(f){var j=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};for(var k in j)f.addEventListener(k,j[k])}//class:CanvasObjLibrary
var b={Event:function Event(f){return function(){function _class(k){_classCallCheck(this,_class),this.type=k,this.timeStamp=Date.now()}return _class}()},GraphEvent:function GraphEvent(f){return function(_f$class$Event){function _class2(k){_classCallCheck(this,_class2);var _this=_possibleConstructorReturn(this,_f$class$Event.call(this,k));return _this.target=null,_this.propagation=!0,_this.stoped=!1,_this.target=null,_this}return _inherits(_class2,_f$class$Event),_class2.prototype.stopPropagation=function stopPropagation(){this.propagation=!1},_class2.prototype.stopImmediatePropagation=function stopImmediatePropagation(){this.stoped=!0},_createClass(_class2,[{key:'altKey',get:function get(){return this.originEvent.altKey}},{key:'ctrlKey',get:function get(){return this.originEvent.ctrlKey}},{key:'metaKey',get:function get(){return this.originEvent.metaKey}},{key:'shiftKey',get:function get(){return this.originEvent.shiftKey}}]),_class2}(f.class.Event)},MouseEvent:function MouseEvent(f){return function(_f$class$GraphEvent){function _class3(k){return _classCallCheck(this,_class3),_possibleConstructorReturn(this,_f$class$GraphEvent.call(this,k))}return _inherits(_class3,_f$class$GraphEvent),_createClass(_class3,[{key:'button',get:function get(){return this.originEvent.button}},{key:'buttons',get:function get(){return this.originEvent.buttons}},{key:'movementX',get:function get(){return f.stat.mouse.x-f.stat.previousX}},{key:'movementY',get:function get(){return f.stat.mouse.y-f.stat.previousY}}]),_class3}(f.class.GraphEvent)},WheelEvent:function WheelEvent(f){return function(_f$class$MouseEvent){function _class4(k){return _classCallCheck(this,_class4),_possibleConstructorReturn(this,_f$class$MouseEvent.call(this,k))}return _inherits(_class4,_f$class$MouseEvent),_createClass(_class4,[{key:'deltaX',get:function get(){return this.originEvent.deltaX}},{key:'deltaY',get:function get(){return this.originEvent.deltaY}},{key:'deltaZ',get:function get(){return this.originEvent.deltaZ}},{key:'deltaMode',get:function get(){return this.originEvent.deltaMode}}]),_class4}(f.class.MouseEvent)},KeyboardEvent:function KeyboardEvent(f){return function(_f$class$GraphEvent2){function _class5(k){return _classCallCheck(this,_class5),_possibleConstructorReturn(this,_f$class$GraphEvent2.call(this,k))}return _inherits(_class5,_f$class$GraphEvent2),_createClass(_class5,[{key:'key',get:function get(){return this.originEvent.key}},{key:'code',get:function get(){return this.originEvent.code}},{key:'repeat',get:function get(){return this.originEvent.repeat}},{key:'keyCode',get:function get(){return this.originEvent.keyCode}},{key:'charCode',get:function get(){return this.originEvent.charCode}},{key:'location',get:function get(){return this.originEvent.location}}]),_class5}(f.class.GraphEvent)},GraphEventEmitter:function GraphEventEmitter(f){return function(){function _class6(){_classCallCheck(this,_class6),this._events={}}return _class6.prototype.emit=function emit(k){!1==k instanceof f.class.Event||(k.target=this,this._resolve(k))},_class6.prototype._resolve=function _resolve(k){if(k.type in this._events){var l=this._events[k.type];try{for(var _iterator=l,_isArray=Array.isArray(_iterator),_i=0,_iterator=_isArray?_iterator:_iterator[Symbol.iterator]();;){var _ref;if(_isArray){if(_i>=_iterator.length)break;_ref=_iterator[_i++]}else{if(_i=_iterator.next(),_i.done)break;_ref=_i.value}var o=_ref;if(o.call(this,k),k.stoped)return};}catch(o){console.error(o)}}!0===k.propagation&&this.parentNode&&this.parentNode._resolve(k)},_class6.prototype.on=function on(k,l){l instanceof Function&&(!(k in this._events)&&(this._events[k]=[]),this._events[k].push(l))},_class6.prototype.removeEvent=function removeEvent(k,l){if(k in this._events){if(1===arguments.length)return void delete this._events[k];var _o=void 0;(_o=0<=this._events[k].indexOf(l))&&this._events[k].splice(_o,1),0===this._events[k].length&&delete this._events[k]}},_class6}()},GraphStyle:function GraphStyle(f){return function(){function _class7(k){_classCallCheck(this,_class7),k&&this.inhert(k)||(this.__proto__.__proto__=f.default.style)}return _class7.prototype.inhertGraph=function inhertGraph(k){//inhert a graph's style
if(!(k instanceof f.class.Graph))throw new TypeError('graph is not a Graph instance');return this.inhertStyle(k.style),!0},_class7.prototype.inhertStyle=function inhertStyle(k){if(!(k instanceof f.class.GraphStyle))throw new TypeError('graph is not a Graph instance');return this.__proto__=k,!0},_class7.prototype.inhert=function inhert(k){return k instanceof f.class.Graph?(this.inhertGraph(k),!0):!!(k instanceof f.class.GraphStyle)&&(this.inhertStyle(k),!0)},_class7.prototype.cancelInhert=function cancelInhert(){this.__proto__=Object.prototype},_class7.prototype.getPoint=function getPoint(k){return'center'===k?[this.width/2,this.height/2]:[0,0]},_class7.prototype.zoom=function zoom(k,l){1==arguments.length?this.zoomX=this.zoomY=k:(this.zoomX=k,this.zoomY=l)},_class7.prototype.setSize=function setSize(k,l){this.width=k,this.height=l},_class7.prototype.setRotatePoint=function setRotatePoint(k,l){if(2==arguments.length)this.rotatePointX=k,this.rotatePointY=l;else if(1==arguments.length){var o=this.getPoint(k);this.rotatePointX=o[0],this.rotatePointY=o[1]}},_class7.prototype.setPositionPoint=function setPositionPoint(k,l){if(2==arguments.length)this.positionPointX=k,this.positionPointY=l;else if(1==arguments.length){var o=this.getPoint(k);this.positionPointX=o[0],this.positionPointY=o[1]}},_class7.prototype.setZoomPoint=function setZoomPoint(k,l){if(2==arguments.length)this.zoomPointY=k,this.zoomPointY=l;else if(1==arguments.length){var o=this.getPoint(k);this.zoomPointX=o[0],this.zoomPointY=o[1]}},_class7.prototype.setSkewPoint=function setSkewPoint(k,l){if(2==arguments.length)this.zoomPointY=k,this.zoomPointY=l;else if(1==arguments.length){var o=this.getPoint(k);this.skewPointX=o[0],this.skewPointY=o[1]}},_class7}()},Graph:function Graph(f){return function(_f$class$GraphEventEm){function _class8(){_classCallCheck(this,_class8);//this.name=name;
var _this5=_possibleConstructorReturn(this,_f$class$GraphEventEm.call(this));return Object.defineProperties(_this5,{style:{value:new f.class.GraphStyle,configurable:!0},childNodes:{value:[]},parentNode:{value:void 0,configurable:!0}}),_this5.host=f,_this5.GID=_this5.host.generateGraphID(),Object.defineProperties(_this5,{style:{value:new f.class.GraphStyle,configurable:!0},childNodes:{value:[]},parentNode:{value:void 0,configurable:!0}}),_this5}return _inherits(_class8,_f$class$GraphEventEm),_class8.prototype.createShadow=function createShadow(){var k=Object.create(this);return k.GID=this.host.generateGraphID(),k.shadowParent=this,Object.defineProperties(k,{style:{value:new f.class.GraphStyle(this.style),configurable:!0},//childNodes:{value: []},
parentNode:{value:void 0,configurable:!0}}),k},_class8.prototype.appendChild=function appendChild(k){if(!(k instanceof f.class.Graph))throw new TypeError('graph is not a Graph instance');if(k===this)return!1;if(k.parentNode!==this)Object.defineProperty(k,'parentNode',{value:this});else{var l=this.findChild(k);0<=l&&this.childNodes.splice(l,1)}this.childNodes.push(k)},_class8.prototype.insertAfert=function insertAfert(k){if(!(k instanceof f.class.Graph))throw new TypeError('graph is not a Graph instance');if(k===this)return!1;var l=k.parentNode,o=void 0,q=void 0;return!!l&&(q=l.findChild(k),!(0>q)&&void(l===this.parentNode?(o=l.findChild(this),0<=o&&l.childNodes.splice(o,1)):Object.defineProperty(this,'parentNode',{value:l}),l.childNodes.splice(o<q?q:q+1,0,this)))},_class8.prototype.insertBefore=function insertBefore(k){if(!(k instanceof f.class.Graph))throw new TypeError('graph is not a Graph instance');if(k===this)return!1;var l=k.parentNode,o=void 0,q=void 0;return!!l&&(q=l.findChild(k),!(0>q)&&void(l===this.parentNode?(o=l.findChild(this),0<=o&&l.childNodes.splice(o,1)):Object.defineProperty(this,'parentNode',{value:l}),l.childNodes.splice(o<q?q-1:q,0,this)))},_class8.prototype.findChild=function findChild(k){for(var l=this.childNodes.length;l--;)if(this.childNodes[l]===k)return l;return-1},_class8.prototype.removeChild=function removeChild(k){var l=this.findChild(k);0>l||(this.childNodes.splice(l,1),Object.defineProperty(this,'parentNode',{value:void 0}))},_class8.prototype.checkIfOnOver=function checkIfOnOver(){var k=this.host.stat.mouse;return null!==k.x&&(this===this.host.tmp.onOverGraph||(this.host.debug.switch&&(this.host.context.save(),this.host.context.strokeStyle='yellow',this.host.context.stroke(),this.host.context.restore()),!!this.host.context.isPointInPath(k.x,k.y)&&(this.host.tmp.onOverGraph=this,!0)))},_class8.prototype.delete=function _delete(){this.parentNode&&this.parentNode.removeChild(this),this.host.stat.onover===this&&(this.host.stat.onover=null),this.host.stat.onfocus===this&&(this.host.stat.onfocus=null)},_class8}(f.class.GraphEventEmitter)},FunctionGraph:function FunctionGraph(f){return function(_f$class$Graph){function _class9(k){_classCallCheck(this,_class9);var _this6=_possibleConstructorReturn(this,_f$class$Graph.call(this));return _this6.style.debugBorderColor='#f00',k instanceof Function&&(_this6.drawer=k),_this6.style.debugBorderColor='#f00',_this6}return _inherits(_class9,_f$class$Graph),_class9.prototype.drawer=function drawer(k){k.beginPath(),k.rect(0,0,this.style.width,this.style.height),this.checkIfOnOver()},_class9}(f.class.Graph)},ImageGraph:function ImageGraph(f){return function(_f$class$FunctionGrap){function _class10(k){_classCallCheck(this,_class10);var _this7=_possibleConstructorReturn(this,_f$class$FunctionGrap.call(this));return _this7.enableEvent=!0,k&&_this7.use(k),_this7.style.debugBorderColor='#0f0',_this7.enableEvent=!0,_this7}return _inherits(_class10,_f$class$FunctionGrap),_class10.prototype.use=function use(k){var _this8=this;if(k instanceof Image)return this.image=k,k.complete?this.resetStyleSize():k.addEventListener('load',function(){_this8.resetStyleSize()}),!0;if(k instanceof HTMLCanvasElement)return this.image=k,this.resetStyleSize(),!0;throw new TypeError('Wrong image type')},_class10.prototype.resetStyleSize=function resetStyleSize(){this.style.width=this.width,this.style.height=this.height},_class10.prototype.drawer=function drawer(k){k.beginPath(),k.drawImage(this.image,0,0),this.enableEvent&&(k.beginPath(),k.rect(0,0,this.style.width,this.style.height),this.checkIfOnOver())},_createClass(_class10,[{key:'width',get:function get(){return this.image instanceof Image?this.image.naturalWidth:this.image instanceof HTMLCanvasElement?this.image.width:0}},{key:'height',get:function get(){return this.image instanceof Image?this.image.naturalHeight:this.image instanceof HTMLCanvasElement?this.image.height:0}}]),_class10}(f.class.FunctionGraph)},CanvasGraph:function CanvasGraph(f){return function(_f$class$ImageGraph){function _class11(){_classCallCheck(this,_class11);var _this9=_possibleConstructorReturn(this,_f$class$ImageGraph.call(this));return _this9.autoClear=!0,_this9.image=document.createElement('canvas'),_this9.context=_this9.image.getContext('2d'),_this9.autoClear=!0,_this9}return _inherits(_class11,_f$class$ImageGraph),_class11.prototype.draw=function draw(k){this.autoClear&&this.context.clearRect(0,0,this.width,this.height),k(this.context)},_createClass(_class11,[{key:'width',set:function set(k){this.image.width=k}},{key:'height',set:function set(k){this.image.height=k}}]),_class11}(f.class.ImageGraph)},TextGraph:function TextGraph(f){return function(_f$class$FunctionGrap2){function _class12(){var k=0<arguments.length&&void 0!==arguments[0]?arguments[0]:'';_classCallCheck(this,_class12);var _this10=_possibleConstructorReturn(this,_f$class$FunctionGrap2.call(this));return Object.defineProperty(_this10,'_cache',{configurable:!0}),_this10.text=k,_this10.font=Object.create(f.default.font),_this10._fontString='',_this10.realtimeRender=!1,_this10._renderList=null,_this10.autoSize=!0,_this10.enableEvent=!0,_this10.style.debugBorderColor='#00f',_this10._cache=null,Object.defineProperty(_this10,'_cache',{configurable:!0}),_this10}return _inherits(_class12,_f$class$FunctionGrap2),_class12.prototype.prepare=function prepare(){this._cache||this.realtimeRender||Object.defineProperty(this,'_cache',{value:document.createElement('canvas')});var k='';if(this.font.fontStyle&&(k=this.fontStyle),this.font.fontVariant&&(k=k+' '+this.fontVariant),this.font.fontWeight&&(k=k+' '+this.fontWeight),k=k+' '+this.font.fontSize+'px',this.font.fontFamily&&(k=k+' '+this.fontFamily),this._fontString=k,!this.realtimeRender){var _l=this._cache,_o2=_l.getContext('2d');if(_o2.font=k,_o2.clearRect(0,0,_l.width,_l.height),this._renderList=this.text.split(/\n/g),this.estimatePadding=Math.max(this.font.shadowBlur+5+Math.max(Math.abs(this.font.shadowOffsetY),Math.abs(this.font.shadowOffsetX)),this.font.strokeWidth+3),this.autoSize){var q=0,s=void 0,u='number'==typeof this.font.lineHeigh?this.font.lineHeigh:this.font.fontSize;for(var v=this._renderList.length;v--;)s=_o2.measureText(this._renderList[v]).width,s>q&&(q=s);_l.width=(this.style.width=q)+2*this.estimatePadding,_l.height=(this.style.height=this._renderList.length*u)+(u<this.font.fontSize)?2*this.font.fontSize:0+2*this.estimatePadding}else _l.width=this.style.width,_l.height=this.style.height;_o2.translate(this.estimatePadding,this.estimatePadding),this.render(_o2)}},_class12.prototype.render=function render(k){//render text
if(this._renderList){k.font=this._fontString,k.textBaseline='top',k.lineWidth=this.font.strokeWidth,k.fillStyle=this.font.color,k.strokeStyle=this.font.strokeColor,k.shadowBlur=this.font.shadowBlur,k.shadowOffsetX=this.font.shadowOffsetX,k.shadowOffsetY=this.font.shadowOffsetY;for(var l=this._renderList.length;l--;)this.font.fill&&k.fillText(this._renderList[l],0,this.font.lineHeight*l),this.font.strokeWidth&&k.strokeText(this._renderList[l],0,this.font.lineHeight*l)}//set font
},_class12.prototype.drawer=function drawer(k){k.beginPath(),this.realtimeRender?(this.enableEvent&&(k.rect(0,0,this.style.width,this.style.height),this.checkIfOnOver()),this.render(k)):(!this._cache&&this.prepare(),k.drawImage(this._cache,-this.estimatePadding,-this.estimatePadding),this.enableEvent&&(k.rect(0,0,this.style.width,this.style.height),this.checkIfOnOver()))},_class12}(f.class.FunctionGraph)}};window.CanvasObjLibrary=function(){function _class13(j){var _this11=this;if(_classCallCheck(this,_class13),!1==j instanceof HTMLCanvasElement)throw new TypeError('canvas required');//set classes
for(var k in this,Object.assign(this,{/*The main canvas*/canvas:j,/*Canvas' context*/context:j.getContext('2d'),default:{/*default font*/font:{fontStyle:null,fontWeight:null,fontVariant:null,color:'#000',lineHeight:14,fontSize:14,fontFamily:'Arial',strokeWidth:0,strokeColor:'#000',shadowBlur:0,shadowColor:'#000',shadowOffsetX:0,shadowOffsetY:0,fill:!0,lineHeight:18,reverse:!1},style:{x:0,y:0,zoomX:1,zoomY:1,width:1,height:1,rotate:0,hidden:!1,opacity:1,clipOverflow:!1,backgroundColor:null,rotatePointX:0,rotatePointY:0,positionPointX:0,positionPointY:0,zoomPointY:0,zoomPointY:0,skewX:1,skewY:1,skewPointX:0,skewPointY:0,composite:null,debugBorderColor:'black'}},stat:{mouse:{x:null,y:null,previousX:null,previousY:null},/*The currently focused on obj*/onfocus:null,/*The currently mouseover obj*/onover:null,canvasOnFocus:!1,canvasOnOver:!1},tmp:{graphID:0,onOverGraph:null,toClickGraph:null},root:null,//root Graph
class:{},autoClear:!0,//Debug info
debug:{switch:!1,count:0,FPS:0,_lastFrameTime:Date.now(),_recordOffset:0,_timeRecorder:new Uint32Array(15),//记录5帧绘制时的时间来计算fps
on:function on(){this.switch=!0},off:function off(){this.switch=!1}}}),b)this.class[k]=b[k](this);//init root graph
this.root=new this.class.FunctionGraph,this.root.name='root',Object.defineProperty(this.root,'parentNode',{configurable:!1}),this.adjustCanvas(),a(j,{mouseout:function mouseout(k){_this11.stat.canvasOnOver=!1,_this11.stat.mouse.x=null,_this11.stat.mouse.y=null,_this11.stat.onover,_this11._commonEventHandle(k),_this11.stat.onover=null},mouseover:function mouseover(){_this11.stat.canvasOnOver=!0},mousemove:function mousemove(k){_this11.tmp.toClick=!1,_this11._commonEventHandle(k)},mousedown:function mousedown(k){_this11.tmp.toClickGraph=_this11.stat.onover,_this11.stat.canvasOnFocus=!0,_this11.stat.onfocus=_this11.stat.onover,_this11._commonEventHandle(k)},mouseup:function mouseup(k){return _this11._commonEventHandle(k)},click:function click(k){_this11.tmp.toClickGraph&&_this11._commonEventHandle(k)},dblclick:function dblclick(k){return _this11._commonEventHandle(k)},selectstart:function selectstart(k){return k.preventDefault()},wheel:function wheel(k){var l=new _this11.class.WheelEvent('wheel');l.originEvent=k,(_this11.stat.onover||_this11.root).emit(l)}}),a(document,{mousedown:function mousedown(k){k.target!==_this11.canvas&&(_this11.stat.canvasOnFocus=!1)},mouseout:function mouseout(){if(null!==_this11.stat.mouse.x){var _k=new window.MouseEvent('mouseout');_this11.canvas.dispatchEvent(_k)}},keydown:function keydown(k){return _this11._commonEventHandle(k)},keyup:function keyup(k){return _this11._commonEventHandle(k)},keypress:function keypress(k){return _this11._commonEventHandle(k)}})}return _class13.prototype.generateGraphID=function generateGraphID(){return++this.tmp.graphID},_class13.prototype.adjustCanvas=function adjustCanvas(){var j=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.canvas.offsetWidth,k=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.canvas.offsetHeight;this.root.style.width=this.canvas.width=j,this.root.style.height=this.canvas.height=k;var l=new this.class.Event('resize');this.root.emit(l)},_class13.prototype._commonEventHandle=function _commonEventHandle(j){if(j instanceof MouseEvent){this.stat.previousX=this.stat.mouse.x,this.stat.previousY=this.stat.mouse.y,this.stat.mouse.x=j.layerX,this.stat.mouse.y=j.layerY;var k=new this.class.MouseEvent(j.type);k.originEvent=j,(this.stat.onover||this.root).emit(k)}else if(j instanceof KeyboardEvent){if(!this.stat.canvasOnFocus)return;var _k2=new this.class.KeyboardEvent(j.type);_k2.originEvent=j,(this.stat.onfocus||this.root).emit(_k2)}},_class13.prototype.draw=function draw(){var j=this.context;if(this.debug.count=0,j.setTransform(1,0,0,1,0,0),this.autoClear&&j.clearRect(0,0,this.canvas.width,this.canvas.height),this.drawGraph(this.root),this.debug.switch&&this.drawDebug(),this.tmp.onOverGraph!==this.stat.onover){//new onover graph
var k=this.stat.onover;if(this.tmp.toClickGraph=null,this.stat.onover=this.tmp.onOverGraph,k){var l=new this.class.MouseEvent('mouseout');k.emit(l)}if(this.stat.onover){var _l2=new this.class.MouseEvent('mouseover');this.stat.onover.emit(_l2)}}this.tmp.onOverGraph=null},_class13.prototype.drawDebug=function drawDebug(){var j=this.context,k=this.debug,l=k._timeRecorder,o=Date.now();//fps
l[k._recordOffset++]=o-k._lastFrameTime,k._lastFrameTime=o,15===k._recordOffset&&(k._recordOffset=0),k.FPS=0|15000/(l[0]+l[1]+l[2]+l[3]+l[4]+l[5]+l[6]+l[7]+l[8]+l[9]+l[10]+l[11]+l[12]+l[13]+l[14])+0.5,j.save(),j.beginPath(),j.setTransform(1,0,0,1,0,0),j.font='16px Arial',j.textBaseline='bottom',j.globalCompositeOperation='lighter',j.fillStyle='red',j.fillText('point:'+this.stat.mouse.x+','+this.stat.mouse.y+' FPS:'+this.debug.FPS+' Items:'+this.debug.count,0,this.canvas.height),j.fillText('onover:'+(this.stat.onover?this.stat.onover.GID:'null')+' onfocus:'+(this.stat.onfocus?this.stat.onfocus.GID:'null'),0,this.canvas.height-20),j.strokeStyle='red',j.globalCompositeOperation='source-over',j.moveTo(this.stat.mouse.x,this.stat.mouse.y+6),j.lineTo(this.stat.mouse.x,this.stat.mouse.y-6),j.moveTo(this.stat.mouse.x-6,this.stat.mouse.y),j.lineTo(this.stat.mouse.x+6,this.stat.mouse.y),j.stroke(),j.restore()},_class13.prototype.drawGraph=function drawGraph(j){var k=this.context,l=j.style;if(!l.hidden){//skew
if(this.debug.count++,k.save(),k.globalCompositeOperation=l.composite,k.globalAlpha=l.opacity,k.translate(l.x-l.positionPointX,l.y-l.positionPointY),l.skewX||l.skewY){var o=l.skewPointX||l.skewPointY;o&&k.translate(l.skewPointX,l.skewPointY),k.scale(l.skewX,l.skewY),o&&k.translate(-l.skewPointX,-l.skewPointY)}//rotate
if(l.rotate){var _o3=l.rotatePointX||l.rotatePointY;_o3&&k.translate(l.rotatePointX,l.rotatePointY),k.rotate(0.0174532925*l.rotate),_o3&&k.translate(-l.rotatePointX,-l.rotatePointY)}//zoom
if(1!==l.zoomX||1!==l.zoomY){var _o4=l.zoomPointX||l.zoomPointY;_o4&&k.translate(l.zoomPointX,l.zoomPointX),k.scale(l.zoomX,l.zoomY),_o4&&k.translate(-l.zoomPointX,-l.zoomPointX)}if(this.debug.switch&&(k.save(),k.beginPath(),k.globalAlpha=0.5,k.globalCompositeOperation='source-over',k.strokeStyle=j.style.debugBorderColor,k.strokeWidth=1.5,k.strokeRect(0,0,l.width,l.height),k.strokeWidth=1,k.globalAlpha=1,k.strokeStyle='green',k.strokeRect(l.positionPointX-5,l.positionPointY-5,10,10),k.strokeStyle='blue',k.strokeRect(l.rotatePointX-4,l.rotatePointX-4,8,8),k.strokeStyle='olive',k.strokeRect(l.zoomPointX-3,l.zoomPointX-3,6,6),k.strokeStyle='#6cf',k.strokeRect(l.skewPointX-2,l.skewPointX-2,4,4),k.restore()),j.style.clipOverflow&&(k.beginPath(),k.rect(0,0,l.width,l.height),k.clip()),j.drawer&&j.drawer(k),j.childNodes.length)for(var _iterator2=j.childNodes,_isArray2=Array.isArray(_iterator2),_i2=0,_iterator2=_isArray2?_iterator2:_iterator2[Symbol.iterator]();;){var _ref2;if(_isArray2){if(_i2>=_iterator2.length)break;_ref2=_iterator2[_i2++]}else{if(_i2=_iterator2.next(),_i2.done)break;_ref2=_i2.value}var _o5=_ref2;this.drawGraph(_o5)}k.restore()}//position & offset
},_class13}(),'function'!=typeof Object.assign&&(Object.assign=function(f){'use strict';// We must check against these specific cases.
if(f===void 0||null===f)throw new TypeError('Cannot convert undefined or null to object');var j=Object(f);for(var k=1;k<arguments.length;k++){var l=arguments[k];if(l!==void 0&&null!==l)for(var o in l)l.hasOwnProperty(o)&&(j[o]=l[o])}return j});Float32Array.__proto__.from||function(){var f=[];Float32Array.__proto__.from=function(j,k,l){var o=Float32Array.__proto__;if('function'!=typeof this)throw new TypeError('# is not a constructor');if(this.__proto__!==o)throw new TypeError('this is not a typed array.');if(k=k||function(s){return s},'function'!=typeof k)throw new TypeError('specified argument is not a function');if(j=Object(j),!j.length)return new this(0);f.length=0;for(var s=0;s<j.length;s++)f.push(j[s]);f=f.map(k,l);var q=new this(f.length);for(var _s2=0;_s2<q.length;_s2++)q[_s2]=f[_s2];return q}}();(function(){if(!window.requestAnimationFrame){var f=0,j=['ms','moz','webkit','o'];for(var k=0;k<j.length&&!window.requestAnimationFrame;++k)window.requestAnimationFrame=window[j[k]+'RequestAnimationFrame'],window.cancelRequestAnimationFrame=window[j[k]+'CancelRequestAnimationFrame'];window.requestAnimationFrame||(window.requestAnimationFrame=function(l,o,q){var s=Date.now(),u=q||Math.max(0,1e3/60-(s-f));l(0);var v=window.setTimeout(function(){l(s+u)},u);return f=s+u,v}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(l){clearTimeout(l)})}})()})();